#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Pillar 22: å¼ºé¡¹ç›®ç®¡ç†ã€åˆ†å·¥åè°ƒã€çŠ¶æ€è·Ÿè¸ªã€æœ€ç»ˆé›†æˆèƒ½åŠ›æµ‹è¯•
æµ‹è¯•æ¨¡å‹åœ¨å¤æ‚é¡¹ç›®ç®¡ç†ã€å›¢é˜Ÿåè°ƒã€çŠ¶æ€ç›‘æ§å’Œæˆæœé›†æˆæ–¹é¢çš„èƒ½åŠ›
"""

import ollama
import sys
import os
import json
import time
import re
from typing import Dict, List, Any
from utils import call_qiniu_deepseek, run_single_test

sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))
try:
    from config import MODEL_TO_TEST
except ImportError:
    print("é”™è¯¯: æ— æ³•ä»config.pyå¯¼å…¥MODEL_TO_TESTã€‚è¯·ç¡®ä¿config.pyå­˜åœ¨äºé¡¹ç›®æ ¹ç›®å½•ã€‚")
    sys.exit(1)

class ProjectManagementTest:
    def __init__(self, model_name: str):
        self.model_name = model_name
        self.model_dir = os.path.join(os.path.dirname(__file__), '..', 'testout', self.model_name.replace(':', '_').replace('/', '_'))
        os.makedirs(self.model_dir, exist_ok=True)

    def call_model(self, prompt, options=None):
        return run_single_test("Pillar 22: Project Management", prompt, self.model_name, options or {}, messages=[], test_script_name="test_pillar_22_project_management.py")[0]
    
    def test_erp_system_integration(self) -> Dict[str, Any]:
        """æµ‹è¯•ERPç³»ç»Ÿé›†æˆé¡¹ç›®çš„å…¨æµç¨‹ç®¡ç†"""
        prompt = """
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„é¡¹ç›®æ€»ç›‘ï¼Œè´Ÿè´£ç®¡ç†ä¸€ä¸ªå¤§å‹ä¼ä¸šERPç³»ç»Ÿé›†æˆé¡¹ç›®ã€‚

é¡¹ç›®èƒŒæ™¯ï¼š
- ä¼ä¸šè§„æ¨¡ï¼š5000äººï¼Œå¹´è¥æ”¶50äº¿
- é¡¹ç›®å‘¨æœŸï¼š18ä¸ªæœˆ
- é¢„ç®—ï¼š2000ä¸‡äººæ°‘å¸
- æ¶‰åŠæ¨¡å—ï¼šè´¢åŠ¡ã€äººåŠ›èµ„æºã€ä¾›åº”é“¾ã€ç”Ÿäº§åˆ¶é€ ã€é”€å”®ã€å®¢æœ

å›¢é˜Ÿç»“æ„ï¼š
1. **æŠ€æœ¯å›¢é˜Ÿ** (15äºº)ï¼šæ¶æ„å¸ˆ2äººã€å¼€å‘å·¥ç¨‹å¸ˆ8äººã€æµ‹è¯•å·¥ç¨‹å¸ˆ3äººã€è¿ç»´å·¥ç¨‹å¸ˆ2äºº
2. **ä¸šåŠ¡å›¢é˜Ÿ** (12äºº)ï¼šä¸šåŠ¡åˆ†æå¸ˆ6äººã€åŸ¹è®­å¸ˆ3äººã€æ•°æ®è¿ç§»ä¸“å‘˜3äºº
3. **ç®¡ç†å›¢é˜Ÿ** (8äºº)ï¼šé¡¹ç›®ç»ç†1äººã€æŠ€æœ¯ç»ç†2äººã€ä¸šåŠ¡ç»ç†2äººã€è´¨é‡ç»ç†1äººã€é£é™©ç»ç†1äººã€æ²Ÿé€šåè°ƒå‘˜1äºº

å½“å‰çŠ¶æ€ï¼ˆé¡¹ç›®è¿›è¡Œåˆ°ç¬¬8ä¸ªæœˆï¼‰ï¼š
- éœ€æ±‚åˆ†æï¼š100%å®Œæˆ
- ç³»ç»Ÿè®¾è®¡ï¼š90%å®Œæˆ
- å¼€å‘è¿›åº¦ï¼šè´¢åŠ¡æ¨¡å—70%ï¼ŒHRæ¨¡å—60%ï¼Œä¾›åº”é“¾40%ï¼Œç”Ÿäº§30%ï¼Œé”€å”®20%ï¼Œå®¢æœ10%
- æµ‹è¯•è¿›åº¦ï¼šè´¢åŠ¡æ¨¡å—å¼€å§‹ç³»ç»Ÿæµ‹è¯•ï¼Œå…¶ä»–æ¨¡å—è¿˜åœ¨å•å…ƒæµ‹è¯•
- æ•°æ®è¿ç§»ï¼šæ–¹æ¡ˆè®¾è®¡å®Œæˆï¼Œå¼€å§‹è¯•ç‚¹è¿ç§»

çªå‘é—®é¢˜ï¼š
1. è´¢åŠ¡æ¨¡å—å‘ç°é‡å¤§æ€§èƒ½é—®é¢˜ï¼Œéœ€è¦æ¶æ„é‡æ„ï¼Œé¢„è®¡å»¶æœŸ1ä¸ªæœˆ
2. ä¸»è¦ä¸šåŠ¡åˆ†æå¸ˆå› ä¸ªäººåŸå› ç¦»èŒï¼Œä¸šåŠ¡éœ€æ±‚ç†è§£å‡ºç°æ–­å±‚
3. å®¢æˆ·æ–¹æå‡ºæ–°å¢ç§»åŠ¨ç«¯éœ€æ±‚ï¼Œå¢åŠ å·¥ä½œé‡çº¦20%
4. ä¾›åº”å•†äº¤ä»˜çš„ä¸­é—´ä»¶å­˜åœ¨å…¼å®¹æ€§é—®é¢˜

è¯·ä½œä¸ºé¡¹ç›®æ€»ç›‘ï¼Œåˆ¶å®šç»¼åˆçš„é¡¹ç›®ç®¡ç†æ–¹æ¡ˆï¼š

1. **çŠ¶æ€åˆ†æä¸è¯Šæ–­**ï¼š
   - ç»˜åˆ¶å½“å‰é¡¹ç›®çŠ¶æ€å›¾ï¼ˆåŒ…å«å„æ¨¡å—è¿›åº¦ã€ä¾èµ–å…³ç³»ã€é£é™©ç‚¹ï¼‰
   - åˆ†æå…³é”®è·¯å¾„å’Œç“¶é¢ˆç¯èŠ‚
   - è¯„ä¼°é¡¹ç›®æ•´ä½“å¥åº·åº¦

2. **å›¢é˜Ÿåˆ†å·¥é‡æ–°è°ƒé…**ï¼š
   - é’ˆå¯¹çªå‘é—®é¢˜é‡æ–°åˆ†é…äººå‘˜
   - è®¾è®¡è·¨å›¢é˜Ÿåä½œæœºåˆ¶
   - åˆ¶å®šçŸ¥è¯†ä¼ æ‰¿å’Œå¤‡ä»½æ–¹æ¡ˆ

3. **çŠ¶æ€è·Ÿè¸ªä½“ç³»**ï¼š
   - è®¾è®¡é¡¹ç›®ä»ªè¡¨æ¿ï¼ˆå…³é”®æŒ‡æ ‡ã€é¢„è­¦æœºåˆ¶ï¼‰
   - å»ºç«‹å¤šå±‚çº§çŠ¶æ€æŠ¥å‘Šæœºåˆ¶ï¼ˆæ—¥æŠ¥ã€å‘¨æŠ¥ã€æœˆæŠ¥ï¼‰
   - åˆ¶å®šé‡Œç¨‹ç¢‘æ£€æŸ¥ç‚¹å’Œè´¨é‡é—¨ç¦

4. **é£é™©åº”å¯¹ä¸é›†æˆç­–ç•¥**ï¼š
   - é’ˆå¯¹4ä¸ªçªå‘é—®é¢˜çš„å…·ä½“è§£å†³æ–¹æ¡ˆ
   - æ¨¡å—é—´é›†æˆæµ‹è¯•è®¡åˆ’
   - æœ€ç»ˆç³»ç»Ÿé›†æˆå’Œä¸Šçº¿ç­–ç•¥

5. **æ²Ÿé€šåè°ƒæœºåˆ¶**ï¼š
   - è·¨å›¢é˜Ÿæ²Ÿé€šæµç¨‹
   - ä¸å®¢æˆ·æ–¹çš„æ²Ÿé€šç­–ç•¥
   - å˜æ›´ç®¡ç†æµç¨‹

è¦æ±‚è¾“å‡ºï¼šé¡¹ç›®çŠ¶æ€å›¾ã€å›¢é˜Ÿåä½œçŸ©é˜µã€é£é™©åº”å¯¹è®¡åˆ’ã€é›†æˆæ—¶é—´çº¿ã€‚
"""
        
        try:
            response = self.call_model(prompt)
            
            return {
                "test_name": "erp_system_integration",
                "prompt": prompt,
                "response": response,
                "timestamp": time.time(),
                "success": True
            }
            
        except Exception as e:
            return {
                "test_name": "erp_system_integration",
                "error": str(e),
                "success": False
            }
    
    def test_multi_site_construction_coordination(self) -> Dict[str, Any]:
        """æµ‹è¯•å¤šåœ°ç‚¹å»ºè®¾é¡¹ç›®çš„åè°ƒç®¡ç†"""
        prompt = """
ä½ æ˜¯ä¸€ä¸ªå¤§å‹è¿é”é…’åº—é›†å›¢çš„é¡¹ç›®æ€»ç›‘ï¼Œè´Ÿè´£åŒæ—¶åœ¨5ä¸ªåŸå¸‚å¼€è®¾æ–°é…’åº—çš„é¡¹ç›®ã€‚

é¡¹ç›®æ¦‚å†µï¼š
- åŸå¸‚ï¼šåŒ—äº¬ã€ä¸Šæµ·ã€å¹¿å·ã€æˆéƒ½ã€è¥¿å®‰
- æ¯ä¸ªé…’åº—ï¼š200é—´å®¢æˆ¿ï¼Œé¢„ç®—5000ä¸‡ï¼Œå·¥æœŸ12ä¸ªæœˆ
- æ€»å›¢é˜Ÿï¼š150äººï¼Œåˆ†å¸ƒåœ¨5ä¸ªåŸå¸‚

å„åŸå¸‚é¡¹ç›®çŠ¶æ€ï¼ˆç¬¬6ä¸ªæœˆï¼‰ï¼š
- **åŒ—äº¬**ï¼šåœŸå»º90%ï¼Œè£…ä¿®30%ï¼Œè®¾å¤‡é‡‡è´­70%ï¼Œäººå‘˜æ‹›è˜50%
- **ä¸Šæµ·**ï¼šåœŸå»º70%ï¼Œè£…ä¿®10%ï¼Œè®¾å¤‡é‡‡è´­80%ï¼Œäººå‘˜æ‹›è˜30%
- **å¹¿å·**ï¼šåœŸå»º95%ï¼Œè£…ä¿®50%ï¼Œè®¾å¤‡é‡‡è´­60%ï¼Œäººå‘˜æ‹›è˜70%
- **æˆéƒ½**ï¼šåœŸå»º60%ï¼Œè£…ä¿®0%ï¼Œè®¾å¤‡é‡‡è´­40%ï¼Œäººå‘˜æ‹›è˜20%
- **è¥¿å®‰**ï¼šåœŸå»º80%ï¼Œè£…ä¿®20%ï¼Œè®¾å¤‡é‡‡è´­50%ï¼Œäººå‘˜æ‹›è˜40%

å›¢é˜Ÿåˆ†å·¥ï¼š
- **æ€»éƒ¨å›¢é˜Ÿ**ï¼šé¡¹ç›®æ€»ç›‘1äººã€è®¾è®¡æ€»ç›‘1äººã€é‡‡è´­æ€»ç›‘1äººã€è¿è¥æ€»ç›‘1äººã€è´¨é‡æ€»ç›‘1äºº
- **å„åœ°å›¢é˜Ÿ**ï¼šç°åœºç»ç†1äººã€å·¥ç¨‹å¸ˆ3äººã€é‡‡è´­ä¸“å‘˜2äººã€HRä¸“å‘˜1äººã€è´¨é‡ä¸“å‘˜1äºº

å½“å‰æŒ‘æˆ˜ï¼š
1. æˆéƒ½é­é‡è¿ç»­æš´é›¨ï¼ŒåœŸå»ºè¿›åº¦ä¸¥é‡æ»å
2. ä¸Šæµ·è£…ä¿®ææ–™ä¾›åº”å•†å‡ºç°è´¨é‡é—®é¢˜ï¼Œéœ€è¦é‡æ–°é‡‡è´­
3. å¹¿å·æå‰å®Œæˆï¼Œä½†å‘ç°è®¾è®¡ç¼ºé™·éœ€è¦è¿”å·¥
4. è¥¿å®‰å½“åœ°æ”¿ç­–å˜åŒ–ï¼Œéœ€è¦é¢å¤–çš„ç¯ä¿å®¡æ‰¹
5. åŒ—äº¬äººå‘˜æ‹›è˜å›°éš¾ï¼Œå…³é”®å²—ä½ç©ºç¼º

é›†å›¢è¦æ±‚ï¼š
- æ‰€æœ‰é…’åº—å¿…é¡»åœ¨åŒä¸€æ—¶é—´ï¼ˆç¬¬12ä¸ªæœˆæœ«ï¼‰å¼€ä¸š
- ä¿è¯ç»Ÿä¸€çš„å“ç‰Œæ ‡å‡†å’ŒæœåŠ¡è´¨é‡
- æ§åˆ¶æ€»é¢„ç®—ä¸è¶…æ”¯

è¯·åˆ¶å®šç»¼åˆçš„å¤šé¡¹ç›®åè°ƒç®¡ç†æ–¹æ¡ˆï¼š

1. **æ•´ä½“çŠ¶æ€ç›‘æ§**ï¼š
   - è®¾è®¡5åŸå¸‚é¡¹ç›®çŠ¶æ€æ€»è§ˆå›¾
   - å»ºç«‹ç»Ÿä¸€çš„è¿›åº¦è·Ÿè¸ªä½“ç³»
   - åˆ¶å®šé¢„è­¦å’Œå‡çº§æœºåˆ¶

2. **èµ„æºåŠ¨æ€è°ƒé…**ï¼š
   - äººå‘˜åœ¨åŸå¸‚é—´çš„çµæ´»è°ƒé…æ–¹æ¡ˆ
   - è®¾å¤‡å’Œææ–™çš„ç»Ÿä¸€é‡‡è´­å’Œè°ƒé…
   - ç»éªŒå’Œæœ€ä½³å®è·µçš„è·¨åŸå¸‚åˆ†äº«

3. **é£é™©ååŒåº”å¯¹**ï¼š
   - é’ˆå¯¹5ä¸ªåŸå¸‚å…·ä½“é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ
   - å»ºç«‹åŸå¸‚é—´äº’åŠ©æœºåˆ¶
   - åˆ¶å®šåº”æ€¥é¢„æ¡ˆå’Œå¤‡é€‰æ–¹æ¡ˆ

4. **è´¨é‡ç»Ÿä¸€ä¿è¯**ï¼š
   - è·¨åŸå¸‚çš„è´¨é‡æ ‡å‡†å’Œæ£€æŸ¥ä½“ç³»
   - ç»Ÿä¸€çš„åŸ¹è®­å’Œè®¤è¯æœºåˆ¶
   - å“ç‰Œæ ‡å‡†çš„ä¸€è‡´æ€§ä¿è¯

5. **æœ€ç»ˆé›†æˆå¼€ä¸š**ï¼š
   - åŒæ­¥å¼€ä¸šçš„æ—¶é—´åè°ƒæ–¹æ¡ˆ
   - å¼€ä¸šå‰çš„è”åˆæ¼”ç»ƒè®¡åˆ’
   - å¼€ä¸šåçš„æŒç»­æ”¯æŒæœºåˆ¶

è¦æ±‚è¾“å‡ºï¼šå¤šåŸå¸‚çŠ¶æ€çŸ©é˜µã€èµ„æºè°ƒé…è®¡åˆ’ã€åŒæ­¥å¼€ä¸šæ—¶é—´çº¿ã€‚
"""
        
        try:
            response = self.call_model(prompt)
            
            return {
                "test_name": "multi_site_construction",
                "prompt": prompt,
                "response": response,
                "timestamp": time.time(),
                "success": True
            }
            
        except Exception as e:
            return {
                "test_name": "multi_site_construction",
                "error": str(e),
                "success": False
            }
    
    def test_product_launch_integration(self) -> Dict[str, Any]:
        """æµ‹è¯•æ–°äº§å“å‘å¸ƒçš„å…¨æµç¨‹é›†æˆç®¡ç†"""
        prompt = """
ä½ æ˜¯ä¸€å®¶ç§‘æŠ€å…¬å¸çš„äº§å“å‘å¸ƒæ€»ç›‘ï¼Œè´Ÿè´£ä¸€æ¬¾é©å‘½æ€§æ™ºèƒ½æ‰‹è¡¨çš„å…¨çƒå‘å¸ƒé¡¹ç›®ã€‚

äº§å“èƒŒæ™¯ï¼š
- äº§å“ï¼šä¸‹ä¸€ä»£å¥åº·ç›‘æµ‹æ™ºèƒ½æ‰‹è¡¨
- ç›®æ ‡å¸‚åœºï¼šå…¨çƒ15ä¸ªå›½å®¶åŒæ­¥å‘å¸ƒ
- å‘å¸ƒæ—¶é—´ï¼š6ä¸ªæœˆåçš„å…¨çƒå‘å¸ƒä¼š
- é¢„æœŸé”€é‡ï¼šé¦–å¹´100ä¸‡å°

æ¶‰åŠéƒ¨é—¨å’Œå›¢é˜Ÿï¼š
1. **ç ”å‘å›¢é˜Ÿ** (50äºº)ï¼šç¡¬ä»¶15äººã€è½¯ä»¶20äººã€ç®—æ³•10äººã€æµ‹è¯•5äºº
2. **ä¾›åº”é“¾å›¢é˜Ÿ** (30äºº)ï¼šé‡‡è´­10äººã€ç”Ÿäº§15äººã€ç‰©æµ5äºº
3. **å¸‚åœºå›¢é˜Ÿ** (40äºº)ï¼šå“ç‰Œ5äººã€å¹¿å‘Š10äººã€å…¬å…³10äººã€æ¸ é“15äºº
4. **é”€å”®å›¢é˜Ÿ** (60äºº)ï¼šå„å›½é”€å”®ç»ç†15äººã€æ¸ é“åˆä½œ45äºº
5. **è¿è¥å›¢é˜Ÿ** (20äºº)ï¼šå®¢æœ10äººã€æŠ€æœ¯æ”¯æŒ5äººã€æ•°æ®åˆ†æ5äºº

å½“å‰çŠ¶æ€ï¼ˆå‘å¸ƒå‰3ä¸ªæœˆï¼‰ï¼š
- **ç ”å‘è¿›åº¦**ï¼šç¡¬ä»¶95%å®Œæˆï¼Œè½¯ä»¶90%å®Œæˆï¼Œç®—æ³•ä¼˜åŒ–85%å®Œæˆ
- **ä¾›åº”é“¾çŠ¶æ€**ï¼šæ ¸å¿ƒèŠ¯ç‰‡å·²é”å®šï¼Œä½†ç”µæ± ä¾›åº”å•†å‡ºç°äº§èƒ½é—®é¢˜
- **å¸‚åœºå‡†å¤‡**ï¼šå“ç‰Œå®šä½å®Œæˆï¼Œå¹¿å‘Šåˆ›æ„åˆ¶ä½œä¸­ï¼Œ15å›½æ¸ é“è°ˆåˆ¤è¿›è¡Œä¸­
- **ç›‘ç®¡è®¤è¯**ï¼šå·²è·å¾—8å›½è®¤è¯ï¼Œè¿˜æœ‰7å›½åœ¨å®¡æ‰¹ä¸­
- **ç”Ÿäº§å‡†å¤‡**ï¼šç”Ÿäº§çº¿è°ƒè¯•å®Œæˆï¼Œä½†è‰¯å“ç‡åªæœ‰80%ï¼ˆç›®æ ‡95%ï¼‰

å…³é”®æŒ‘æˆ˜ï¼š
1. ç”µæ± ä¾›åº”å•†äº§èƒ½ä¸è¶³ï¼Œå¯èƒ½å½±å“é¦–æ‰¹50ä¸‡å°ç”Ÿäº§
2. 3ä¸ªé‡è¦å¸‚åœºçš„ç›‘ç®¡è®¤è¯å»¶è¿Ÿï¼Œå¯èƒ½æ— æ³•åŒæ­¥å‘å¸ƒ
3. ç«äº‰å¯¹æ‰‹æå‰å‘å¸ƒç±»ä¼¼äº§å“ï¼Œéœ€è¦è°ƒæ•´å¸‚åœºç­–ç•¥
4. ç”Ÿäº§è‰¯å“ç‡ä¸è¾¾æ ‡ï¼Œæˆæœ¬å’Œè´¨é‡å­˜åœ¨é£é™©
5. å…¨çƒç‰©æµå—ç–«æƒ…å½±å“ï¼Œé…é€æ—¶é—´ä¸ç¡®å®š

å‘å¸ƒè¦æ±‚ï¼š
- 15å›½å¿…é¡»åŒæ­¥å‘å¸ƒï¼Œä¿è¯å…¨çƒå“ç‰Œå½±å“åŠ›
- é¦–æ‰¹50ä¸‡å°å¿…é¡»åœ¨å‘å¸ƒå1ä¸ªæœˆå†…äº¤ä»˜å®Œæˆ
- äº§å“è´¨é‡å¿…é¡»è¾¾åˆ°è¡Œä¸šé¢†å…ˆæ°´å¹³
- å¸‚åœºåå“è¦è¾¾åˆ°é¢„æœŸçš„å“ç‰Œæå‡æ•ˆæœ

è¯·åˆ¶å®šå…¨é¢çš„äº§å“å‘å¸ƒé›†æˆç®¡ç†æ–¹æ¡ˆï¼š

1. **å‘å¸ƒçŠ¶æ€æ€»æ§**ï¼š
   - ç»˜åˆ¶å‘å¸ƒå‡†å¤‡çŠ¶æ€å…¨æ™¯å›¾
   - å»ºç«‹å…³é”®é‡Œç¨‹ç¢‘å’Œä¾èµ–å…³ç³»å›¾
   - è®¾è®¡å‘å¸ƒå€’è®¡æ—¶ç®¡ç†ä½“ç³»

2. **è·¨éƒ¨é—¨åè°ƒæœºåˆ¶**ï¼š
   - åˆ¶å®š5å¤§å›¢é˜Ÿçš„åä½œæµç¨‹
   - å»ºç«‹é—®é¢˜å‡çº§å’Œå†³ç­–æœºåˆ¶
   - è®¾è®¡ä¿¡æ¯å…±äº«å’ŒåŒæ­¥æœºåˆ¶

3. **é£é™©é›†æˆåº”å¯¹**ï¼š
   - é’ˆå¯¹5å¤§æŒ‘æˆ˜çš„ç»¼åˆè§£å†³æ–¹æ¡ˆ
   - å»ºç«‹é£é™©è”åŠ¨åº”å¯¹æœºåˆ¶
   - åˆ¶å®šå‘å¸ƒæˆåŠŸçš„å¤‡é€‰æ–¹æ¡ˆ

4. **è´¨é‡é›†æˆä¿è¯**ï¼š
   - ä»ç ”å‘åˆ°äº¤ä»˜çš„å…¨æµç¨‹è´¨é‡æ§åˆ¶
   - è·¨å›¢é˜Ÿçš„è´¨é‡è´£ä»»ä½“ç³»
   - å‘å¸ƒåçš„å¿«é€Ÿå“åº”æœºåˆ¶

5. **æˆåŠŸé›†æˆéªŒè¯**ï¼š
   - å‘å¸ƒæˆåŠŸçš„å…³é”®æŒ‡æ ‡ä½“ç³»
   - å„å›¢é˜Ÿæˆæœçš„é›†æˆéªŒè¯æ–¹æ³•
   - å‘å¸ƒåçš„æŒç»­ä¼˜åŒ–æœºåˆ¶

è¦æ±‚è¾“å‡ºï¼šå‘å¸ƒçŠ¶æ€å›¾ã€åè°ƒæœºåˆ¶å›¾ã€é£é™©åº”å¯¹çŸ©é˜µã€æˆåŠŸéªŒè¯ä½“ç³»ã€‚
"""
        
        try:
            response = self.call_model(prompt)
            
            return {
                "test_name": "product_launch_integration",
                "prompt": prompt,
                "response": response,
                "timestamp": time.time(),
                "success": True
            }
            
        except Exception as e:
            return {
                "test_name": "product_launch_integration",
                "error": str(e),
                "success": False
            }
    
    def run_comprehensive_test(self) -> Dict[str, Any]:
        """è¿è¡Œç»¼åˆé¡¹ç›®ç®¡ç†æµ‹è¯•"""
        print("ğŸš€ å¼€å§‹å¼ºé¡¹ç›®ç®¡ç†ã€åˆ†å·¥åè°ƒã€çŠ¶æ€è·Ÿè¸ªã€æœ€ç»ˆé›†æˆèƒ½åŠ›æµ‹è¯•")
        
        results = {}
        
        # æµ‹è¯•1: ERPç³»ç»Ÿé›†æˆé¡¹ç›®
        print("\n=== æµ‹è¯•1: ERPç³»ç»Ÿé›†æˆé¡¹ç›®ç®¡ç† ===")
        results["erp_integration"] = self.test_erp_system_integration()
        
        # æµ‹è¯•2: å¤šåœ°ç‚¹å»ºè®¾åè°ƒ
        print("\n=== æµ‹è¯•2: å¤šåœ°ç‚¹å»ºè®¾é¡¹ç›®åè°ƒ ===")
        results["multi_site_construction"] = self.test_multi_site_construction_coordination()
        
        # æµ‹è¯•3: äº§å“å‘å¸ƒé›†æˆç®¡ç†
        print("\n=== æµ‹è¯•3: äº§å“å‘å¸ƒå…¨æµç¨‹é›†æˆ ===")
        results["product_launch"] = self.test_product_launch_integration()
        
        return {
            "test_suite": "project_management_integration",
            "model": self.model_name,
            "timestamp": time.time(),
            "results": results
        }

def run_test(model=None):
    """è¿è¡Œæµ‹è¯•çš„ä¸»å‡½æ•°"""
    test_model = model if model else MODEL_TO_TEST
    test = ProjectManagementTest(test_model)
    
    # è¿è¡Œç»¼åˆæµ‹è¯•
    results = test.run_comprehensive_test()
    
    # ä¿å­˜ç»“æœ
    output_path = os.path.join(test.model_dir, "project_management_test.json")
    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(results, f, ensure_ascii=False, indent=2)
    
    print(f"\nğŸ“Š æµ‹è¯•å®Œæˆï¼ç»“æœå·²ä¿å­˜åˆ°: {output_path}")
    
    return results

if __name__ == "__main__":
    run_test()
